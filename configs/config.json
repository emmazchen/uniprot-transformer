{
    "model_config":{
        "model_name": "ESMControl",
        "model_kwargs": {
            "encoder": {
                "n_blocks": 6,
                "src_vocab_size": -1,
                "max_seq_len": -1,
                "d_embedding": 320,
                "ff_d_hidden": 80,
                "n_heads": 4,
                "p_drop": 0.1
            },
            "mlp": {
                "l1": {
                    "out_features": 40
                },
                "l2": {
                    "in_features": 40,
                    "out_features": 30
                },
                "l3": {
                    "in_features": 30,
                    "out_features": 4
                }
            },
            "pad_idx": 0
        }
    },

    "loss_config": {
        "loss_fn": "nn.CrossEntropyLoss",
        "num_labels": -1
    },

    "optim_config": {
        "optim_fn": "torch.optim.Adam",
        "optim_kwargs":{
            "lr": 0.00005,
            "betas" : [0.9, 0.999],
            "weight_decay" : 0.0001
        }
    },
    "trainer_config": {
        "max_epochs" : 10,
        "devices" : "4",
        "strategy": "ddp_find_unused_parameters_false",
        "precision" : 16
    },
    "batch_size": 10,
    "wandb_project": "uniprot-transformer-multilabel-esm",
    "dryrun": false
}